<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Network Quizz</title>
    <link rel="stylesheet" href="reveal.js/css/reveal.min.css">
    <link rel="stylesheet" href="reveal.js/css/theme/default.css" id="theme">
    <link rel="stylesheet" href="own/my.css">
    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">

    <!--Add support for earlier versions of Internet Explorer -->
    <!--[if lt IE 9]>
    <script src="reveal.js/lib/js/html5shiv.js"></script>
    <![endif]-->
</head>

<body>
<!-- Wrap the entire slide show in a div using the "reveal" class. -->
<div class="reveal">
    <!-- Wrap all slides in a single "slides" class -->
    <div class="slides">

        <!-- ALL SLIDES GO HERE -->
        <!-- Each section element contains an individual slide -->
        <section>
            <h1>PerfUG #11 : Network Quizz</h1>
            <p>Raphael Luta</p>
        </section>

        <section id="q0">
            <h2>Question 0</h2>
            <p>What is this ?</p>
            <p><img src="images/Q0.png" /><p>
        </section>

        <section id="q1">
            <h2>Question 1</h2>
            <p>Quel bénéfice moyen représente pour un Hedge Fund une diminution de latence de <b><i>1ms</i></b> entre Londres et New York ?</p>
            <p>
                <ul>
                    <li>$10 M</li>
                    <li>$100 M</li>
                    <li>$1 B</li>
                    <li>$10 B</li>
                </ul>
            </p>
        </section>

        <section id="r1">
            <h2>Réponse 1</h2>
            <p>
                <ul>
                    <li>$100 M</li>
                    <li>Financement du Hibernian Express à hauteur de 300 M$</li>
                    <li>Tarif d’interconnexion 50x plus cher que câble actuel</li>
                    <li>Livraison prévue fin 2014-début 2015</li>
                </ul>
            </p>
        </section>

        <section id="q2">
            <h2>Question 2</h2>
            <p>Comment est-ce possible de faire <b>22,5</b> Moctets de transfert par seconde sur une  interface à <b>100 Mb/s</b> ?</p>
        </section>

        <section id="q2-1">
            <p>
                <h3>Conf. 1/3</h3>
                <code>
                    <pre>
                        <b>$ ethtool eth0</b><br/>
                        Settings for eth0:<br/>
                        Speed: 100Mb/s<br/>
                        Duplex: Full
                    </pre>
                </code>
        </section>

        <section id="q2-2">
            <p>
                <h3>Conf. 2/3</h3>
                <code data-trim>
                    <pre>
<b>$ ifconfig eth0</b><br/>
Eth0 	Link encap:Ethernet  HWaddr 4c:72:b9:67:21:75<br/>
inet addr:5.135.179.200  Bcast:5.135.179.255  Mask:255.255.255.0<br/>
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1<br/>
</pre>
                </code>
        </section>

        <section id="q2-3">
            <p>
                <h3>Conf. 3/3</h3>
                <code data-trim>
                    <pre>
<b>$ ab -n 1000 -c 1 http://5.135.179.200:8000/</b><br/>
Benchmarking 5.135.179.200 (be patient)<br/>
Document Path:          /<br/>
Document Length:        42012 bytes<br/>
<br/>
Concurrency Level:      1<br/>
Time taken for tests:   18.349 seconds<br/>
Complete requests:      10000<br/>
Failed requests:        0<br/>
Total transferred:      422860000 bytes<br/>
HTML transferred:       420120000 bytes<br/>
Requests per second:    544.98 [#/sec] (mean)<br/>
Time per request:       1.835 [ms] (mean)<br/>
Time per request:       1.835 [ms] (mean, across all concurrent requests)<br/>
<b>Transfer rate:          22504.84 [Kbytes/sec] received</b><br/>
</pre>
                </code>
            </p>
        </section>

        <section id="r2">
            <h2>Réponse 2</h2>
            <p>
                <ol>
                    <li>Ethernet bypass sous Linux</li>
                    <li>Comportement comme interface lo mais différente</li>
                    <ul>
                        <li>Ne réagit pas aux paramètres lo</li>
                        <li>Ne réagit pas aux paramètres eth0</li>
                    </ul>
                    <li>Exemple possible sur shaping, etc…</li>
                    <li>Sous Mac OS X, comportement différent :</li>
                </ol>
                <code data-trim>
                    <pre>
<b>$ netstat -rn</b><br/>
Destination        Gateway            Flags        Refs      Use   Netif Expire<br/>
default            192.168.1.254      UGSc           18        0     en1<br/>
127                127.0.0.1          UCS             0        0     lo0<br/>
127.0.0.1          127.0.0.1          UH              6   502225     lo0<br/>
192.168.1          link#5             UCS             6        0     en1<br/>
192.168.1.101      127.0.0.1          UHS             0        0     lo0<br/>
</pre>
                </code>
            </p>
        </section>

        <section id="q3">
            <h2>Question 3</h2>
            <p>
                Je veux envoyer un fichier DivX (600 Mo) à un ami qui habite à 1000 m.<br/>
                Quel est le moyen d’envoi le plus rapide ?
            </p>
            <ul>
                <li>ADSL2</li>
                <li>4G</li>
                <li>clé USB</li>
            </ul>
        </section>

        <section id="r3">
            <h2>Réponse 3</h2>
            <ol>
                <li>ADSL -> upload = 768 kbps</li>
                <ul>
                    <li>Transfert au mieux : <b>1h50</b></li>
                </ul>
                <li>4G -> upload moyen 8 Mbps</li>
                <ul>
                    <li>Transfert au mieux : <b>11mn</b></li>
                </ul>
                <li>USB -> écriture 5 MBps, lecture 7 MBps,Marche 6 km/h, Bandwith infinie</li>
                <ul>
                    <li>Transfert au mieux : 120s + 10mn + 90s = <b>14mn</b></li>
                </ul>
            </ol>
        </section>

        <section id="r3-bis">
            <h2>Réponse 3 bis</h2>
            <p><img src="images/R3.png" /><p>
        </section>

        <section id="q4">
            <h2>Question 4</h2>
            <p>Le proxy TCP ci-dessous fonctionne mais les performances sont catastrophiques. Comment l’améliorer ?</p>
            <pre><code data-trim>
def srvDst = args[0],b
def bufferSize = 128 * 1024  // 128 kB

def server = new ServerSocket(4444)
server.setReceiveBufferSize(bufferSize)

while(true) {
    server.accept { socket ->
        socket.setTcpNoDelay(true)
        def client = new Socket(srvDst,8080)
        client.setTcpNoDelay(true)
        client.setSendBufferSize(bufferSize)
        socket.withStreams { sinput, soutput ->
            client.withStreams { cinput, coutput ->
                while ((b = sinput.read()) >= 0) coutput.write(b)
            }
        }
        client.close()
    }
}
            </code></pre>
        </section>

        <section id="r4">
            <h2>Réponse 4</h2>
            <ul>
                <li>Réactiver Nagle</li>
                <li>[ou] Buffer des écritures sur une taille ~ MSS</li>
                <li/>
                <li>[et/ou]</li>
                <li>Impact SENDBUF</li>
            </ul>
        </section>

    </div>
</div>
<script src="reveal.js/lib/js/head.min.js"></script>
<script src="reveal.js/js/reveal.min.js"></script>

<script>
    // Required, even if empty.
    Reveal.initialize({
        dependencies: [
            { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
        ]
    });
</script>
</body>
</html>